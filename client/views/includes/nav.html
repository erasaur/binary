<template name="nav">
  <div class="row visible-xs">
  	<div class="col-xs-12">
			<a href="{{pathFor 'home'}}" class="navbar-brand">yamcha</a>
			<div class="pull-right">
				{{> navItems}}
			</div>
		</div>
  </div>
	<div class="navbar navbar-transparent navbar-fixed-top hidden-xs">
		<div class="container row">
			<div class="col-sm-2">
				<a href="{{pathFor 'home'}}" class="navbar-brand pull-right">yamcha</a>
			</div>
			<div class="col-sm-2 col-sm-offset-8">
				<div class="pull-left">
					{{> navItems}}
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="search-modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content custom">
	      <div class="modal-header">
	      	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h3 class="modal-title" id="modalLabel">Search</h3>
	      </div>
	      <div class="modal-body">
	        <form class="form-horizontal" id="search-form" role="form">
						<div class="control-group">
							{{> esInput index=indexes classes="form-control" id="search-input" placeholder="Start Typing Here..."}}
						</div>
						
						<div class="results">
							<ul>
								<li>Topics</li>
								{{#ifEsInputIsEmpty index="topics" id="search-input"}}
									<li>Search for topics.</li>
								{{/ifEsInputIsEmpty}}

								{{#ifEsIsSearching index="topics"}}
									<li>Working on it...</li>
								{{else}}
									{{#esEach index="topics" id="search-input"}}
				          	<li><span class="label label-success">{{this.pro}}</span><span class="label label-danger">{{this.con}}</span><a href="{{pathFor 'topic'}}" class="search-link">{{this.title}}</a></li>
					        {{/esEach}}
								{{/ifEsIsSearching}}

				        {{#ifEsHasNoResults index="topics" id="search-input"}}
				          <li>No search results.</li>
				        {{/ifEsHasNoResults}}
			        </ul>
			        <ul>
			        	<li>Users</li>
								{{#ifEsInputIsEmpty index="users" id="search-input"}}
									<li>Search for users.</li>
								{{/ifEsInputIsEmpty}}

								{{#ifEsIsSearching index="users"}}
									<li>Working on it...</li>
								{{else}}
									{{#esEach index="users" id="search-input"}}
				          	<li><a href="{{pathFor 'profile'}}" class="search-link">{{this.username}}</a></li>
					        {{/esEach}}
								{{/ifEsIsSearching}}

				        {{#ifEsHasNoResults index="users" id="search-input"}}
				          <li>No search results.</li>
				        {{/ifEsHasNoResults}}
			        </ul>
		        </div>
					</form>
	      </div>
	    </div>
	  </div>
	</div>
</template>

<template name="navItems">
	<ul class="nav navbar-nav navbar-right">
		{{#if currentUser}}
			<li><a href="#" data-toggle="modal" data-target="#search-modal"><i class="fa fa-search"></i></a></li>
			<li class="dropdown">
        <a href="#" class="dropdown-toggle" id="nav-profile" data-toggle="dropdown"><i class="fa fa-user"></i></a>
        <div class="dropdown-menu">
        	<ul>
        		<li><a href="{{pathFor 'profile' username=currentUser.username}}"><span>Profile</span></a></li>
						<li><a href="#" id="logout"><span>Log Out</span></a></li>
					</ul>
        </div>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-lightbulb-o"></i></a>
        <div class="dropdown-menu notifications">
        	<ul>
        		{{#if hasNotifications}}
          		{{#each notifications}}
          			<li><a href="{{url}}"><span>{{message}}</span></a></li>
							{{/each}}
						{{else}}
							<li class="padded">No notifications.</li>
						{{/if}}
					</ul>
        </div>
      </li>
    {{/if}}   
	</ul>
</template>